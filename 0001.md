## Question 1 | Sving Customer Objects
Stripe allows you to save credit card details for later. Using an API call, create a customer object leveraging a [Visa test payment method](https://docs.stripe.com/testing?testing-method=payment-methods#visa). For all of the following questions below, you should continue to charge against the same customer object. Provide the customer object ID when this is complete. (example: cus_CDVnj5JnDd6kaf)

Steps:
1. Complete [initial setup of Stripe Shell](https://docs.stripe.com/workbench/shell#initial-setup)
2. Determine how to create a new Customer Object
   1. From the [Visa test payment method](https://docs.stripe.com/testing?testing-method=payment-methods#visa) page, we can see that Visa test cards use the following `PAYMENTMETHOD`: `pm_card_visa`
   2. From a quick search in the Stripe API Documentation, we can find the `Customers` [object documentation](https://docs.stripe.com/api/customers)
   3. The Customer object **requires** the following fields to be created:
        * `api_key`, your API key
        * `name`, customers full name or business name
        * `email`, customers email
        * `payment_method`, users payment method. In this case, `pm_card_visa`
   4. Example API call: 
```bash
curl https://api.stripe.com/v1/customers \
-u "<API_KEY>" \
--data-urlencode email="<CUSTOMER EMAIL?" \
-d payment_method=pm_card_visa \
-d "invoice_settings[default_payment_method]"=pm_card_visa
```
3. API call being used:
```bash
stripe customers create --payment-method="pm_card_visa" --name="Example, Inc." --description="An Example Customer Object" 
```
4. Customer Object JSON:
```json
{
  "id": "cus_Rkb73S7j8T0ZG1",
  "object": "customer",
  "address": null,
  "balance": 0,
  "created": 1739228280,
  "currency": null,
  "default_source": null,
  "delinquent": false,
  "description": "An Example Customer Object",
  "discount": null,
  "email": null,
  "invoice_prefix": "BCBA7145",
  "invoice_settings": {
    "custom_fields": null,
    "default_payment_method": null,
    "footer": null,
    "rendering_options": null
  },
  "livemode": false,
  "metadata": {},
  "name": "Example, Inc.",
  "next_invoice_sequence": 1,
  "phone": null,
  "preferred_locales": [],
  "shipping": null,
  "tax_exempt": "none",
  "test_clock": null
}
```

Customer Card ID; `pm_1Qr5vQR50r9GSPB1IMd2aKQl`
Customer Object ID: `cus_Rkb73S7j8T0ZG1`

## Question 2 | Auth & Capture
Stripe allows its users to auth and capture. This is most commonly used by retailers (like Amazon) who authorize your credit card at the time of checkout, but only capture the charge after they have confirmed that their warehouse has the item or once they have shipped the item.

### 2a. Use an API call to create an authorization for $100. Provide the Payment Intent ID related to this authorization.

Steps:
1. Find the `Authorization` [object documentation](https://docs.stripe.com/api/issuing/authorizations/object) to find how to [create an authorization](https://docs.stripe.com/api/issuing/authorizations/test_mode_create)
2. API call being used:
```bash
stripe test_helpers issuing authorizations create --amount="100" --card="pm_card_visa" 
```
- This generates an error:
```json
{
  "error": {
    "code": "resource_missing",
    "doc_url": "https://stripe.com/docs/error-codes/resource-missing",
    "message": "No such issuing card: 'pm_card_visa'",
    "message_code": "missing_resource_with_message_about_livemode",
    "param": "card",
    "request_log_url": "https://dashboard.stripe.com/test/logs/req_5axXqVlktAp3VT?t=1739228770",
    "type": "invalid_request_error"
  }
}
```

Upon furhter investigation, this seems to be a trick question as Authorization objects have no `paymentintent ID`, however `payment intents` **do**, so we will be pivoting to use a `payment intent` object instead.

1. Find [Payment Intents Creation](https://docs.stripe.com/api/payment_intents/create?lang=cli) docs
2. API call being used:
```bash
stripe payment_intents create --amount="10000" --currency="usd" --capture-method="manual" --customer="cus_Rkb73S7j8T0ZG1" --payment-method="pm_1Qr5vQR50r9GSPB1IMd2aKQl"
```
3. Payment Intent JSON:
```json
{
  "id": "pi_3Qr6qmR50r9GSPB10CBVrg7K",
  "object": "payment_intent",
  "amount": 10000,
  "amount_capturable": 0,
  "amount_details": {
    "tip": {}
  },
  "amount_received": 0,
  "application": null,
  "application_fee_amount": null,
  "automatic_payment_methods": {
    "allow_redirects": "always",
    "enabled": true
  },
  "canceled_at": null,
  "cancellation_reason": null,
  "capture_method": "manual",
  "charges": {
    "object": "list",
    "data": [],
    "has_more": false,
    "total_count": 0,
    "url": "/v1/charges?payment_intent=pi_3Qr6qmR50r9GSPB10CBVrg7K"
  },
  "client_secret": "pi_3Qr6qmR50r9GSPB10CBVrg7K_secret_uysSuyPs0U7QkhisWhVOP8Fjw",
  "confirmation_method": "automatic",
  "created": 1739231836,
  "currency": "usd",
  "customer": "cus_Rkb73S7j8T0ZG1",
  "description": null,
  "invoice": null,
  "last_payment_error": null,
  "latest_charge": null,
  "livemode": false,
  "metadata": {},
  "next_action": null,
  "on_behalf_of": null,
  "payment_method": "pm_1Qr5vQR50r9GSPB1IMd2aKQl",
  "payment_method_configuration_details": {
    "id": "pmc_1Qr5HER50r9GSPB1Db86Mp9s",
    "parent": null
  },
  "payment_method_options": {
    "affirm": {},
    "amazon_pay": {
      "express_checkout_element_session_id": null
    },
    "card": {
      "installments": null,
      "mandate_options": null,
      "network": null,
      "request_three_d_secure": "automatic"
    },
    "cashapp": {},
    "klarna": {
      "preferred_locale": null
    },
    "link": {
      "persistent_token": null
    }
  },
  "payment_method_types": [
    "card",
    "klarna",
    "link",
    "affirm",
    "cashapp",
    "amazon_pay"
  ],
  "processing": null,
  "receipt_email": null,
  "review": null,
  "setup_future_usage": null,
  "shipping": null,
  "source": null,
  "statement_descriptor": null,
  "statement_descriptor_suffix": null,
  "status": "requires_confirmation",
  "transfer_data": null,
  "transfer_group": null
}
```

Payment Intent ID: `pi_3Qr6qmR50r9GSPB10CBVrg7K`

### 2b. Log into your Stripe dashboard (https://dashboard.stripe.com/) and include a screenshot of the payment page for the authorization you just created

Screenshot:
![A Screenshot of the Stripe Dashboard showing a Payment object](img/001.png)
![A Screenshot of the Stripe Dashboard showing a Payment object](img/002.png)

### 2c. Use an API call to create a capture for $75. What happens to a charge if you only capture for a portion of an authorization, and not the full amount?

Steps:
1. Confirm payment intent
```bash
stripe payment_intents confirm pi_3Qr6qmR50r9GSPB10CBVrg7K --capture-method="manual" --return-url="https://example.com"
```
2. JSON object returned:
```json
{
  "id": "pi_3Qr6qmR50r9GSPB10CBVrg7K",
  "object": "payment_intent",
  "amount": 10000,
  "amount_capturable": 10000,
  "amount_details": {
    "tip": {}
  },
  "amount_received": 0,
  "application": null,
  "application_fee_amount": null,
  "automatic_payment_methods": {
    "allow_redirects": "always",
    "enabled": true
  },
  "canceled_at": null,
  "cancellation_reason": null,
  "capture_method": "manual",
  "charges": {
    "object": "list",
    "data": [
      {
        "id": "ch_3Qr6qmR50r9GSPB10hiB9SdC",
        "object": "charge",
        "amount": 10000,
        "amount_captured": 0,
        "amount_refunded": 0,
        "application": null,
        "application_fee": null,
        "application_fee_amount": null,
        "balance_transaction": null,
        "billing_details": {
          "address": {
            "city": null,
            "country": null,
            "line1": null,
            "line2": null,
            "postal_code": null,
            "state": null
          },
          "email": null,
          "name": null,
          "phone": null
        },
        "calculated_statement_descriptor": "Stripe",
        "captured": false,
        "created": 1739232087,
        "currency": "usd",
        "customer": "cus_Rkb73S7j8T0ZG1",
        "description": null,
        "destination": null,
        "dispute": null,
        "disputed": false,
        "failure_balance_transaction": null,
        "failure_code": null,
        "failure_message": null,
        "fraud_details": {},
        "invoice": null,
        "livemode": false,
        "metadata": {},
        "on_behalf_of": null,
        "order": null,
        "outcome": {
          "advice_code": null,
          "network_advice_code": null,
          "network_decline_code": null,
          "network_status": "approved_by_network",
          "reason": null,
          "risk_level": "normal",
          "risk_score": 20,
          "seller_message": "Payment complete.",
          "type": "authorized"
        },
        "paid": true,
        "payment_intent": "pi_3Qr6qmR50r9GSPB10CBVrg7K",
        "payment_method": "pm_1Qr5vQR50r9GSPB1IMd2aKQl",
        "payment_method_details": {
          "card": {
            "amount_authorized": 10000,
            "authorization_code": null,
            "brand": "visa",
            "capture_before": 1739836887,
            "checks": {
              "address_line1_check": null,
              "address_postal_code_check": null,
              "cvc_check": null
            },
            "country": "US",
            "exp_month": 2,
            "exp_year": 2026,
            "extended_authorization": {
              "status": "disabled"
            },
            "fingerprint": "JszuYPo2snHwMFMX",
            "funding": "credit",
            "incremental_authorization": {
              "status": "unavailable"
            },
            "installments": null,
            "issuer": "Stripe Payments UK Limited",
            "last4": "4242",
            "mandate": null,
            "moto": null,
            "multicapture": {
              "status": "unavailable"
            },
            "network": "visa",
            "network_token": {
              "used": false
            },
            "network_transaction_id": "741151221178980",
            "overcapture": {
              "maximum_amount_capturable": 10000,
              "status": "unavailable"
            },
            "regulated_status": "unregulated",
            "three_d_secure": null,
            "wallet": null
          },
          "type": "card"
        },
        "radar_options": {},
        "receipt_email": null,
        "receipt_number": null,
        "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUXI1R2lSNTByOUdTUEIxKNimqr0GMgY2yTUnPEo6LBa7GW9ItxhlzTvIU0ToaRkDRuJzEsaaZTD0mvB7h0aW-mS-mempCZw4GZz1",
        "refunded": false,
        "review": null,
        "shipping": null,
        "source": null,
        "source_transfer": null,
        "statement_descriptor": null,
        "statement_descriptor_suffix": null,
        "status": "succeeded",
        "transfer_data": null,
        "transfer_group": null
      }
    ],
    "has_more": false,
    "total_count": 1,
    "url": "/v1/charges?payment_intent=pi_3Qr6qmR50r9GSPB10CBVrg7K"
  },
  "client_secret": "pi_3Qr6qmR50r9GSPB10CBVrg7K_secret_uysSuyPs0U7QkhisWhVOP8Fjw",
  "confirmation_method": "automatic",
  "created": 1739231836,
  "currency": "usd",
  "customer": "cus_Rkb73S7j8T0ZG1",
  "description": null,
  "invoice": null,
  "last_payment_error": null,
  "latest_charge": "ch_3Qr6qmR50r9GSPB10hiB9SdC",
  "livemode": false,
  "metadata": {},
  "next_action": null,
  "on_behalf_of": null,
  "payment_method": "pm_1Qr5vQR50r9GSPB1IMd2aKQl",
  "payment_method_configuration_details": {
    "id": "pmc_1Qr5HER50r9GSPB1Db86Mp9s",
    "parent": null
  },
  "payment_method_options": {
    "affirm": {},
    "amazon_pay": {
      "express_checkout_element_session_id": null
    },
    "card": {
      "installments": null,
      "mandate_options": null,
      "network": null,
      "request_three_d_secure": "automatic"
    },
    "cashapp": {},
    "klarna": {
      "preferred_locale": null
    },
    "link": {
      "persistent_token": null
    }
  },
  "payment_method_types": [
    "card",
    "klarna",
    "link",
    "affirm",
    "cashapp",
    "amazon_pay"
  ],
  "processing": null,
  "receipt_email": null,
  "review": null,
  "setup_future_usage": null,
  "shipping": null,
  "source": null,
  "statement_descriptor": null,
  "statement_descriptor_suffix": null,
  "status": "requires_capture",
  "transfer_data": null,
  "transfer_group": null
}
```
3. Refer to [Payment Intents Capture](https://docs.stripe.com/api/payment_intents/capture?lang=cli) docs
4. API Call being used: 
```bash
stripe payment_intents capture "pi_3Qr6qmR50r9GSPB10CBVrg7K" --amount-to-capture="7500" 
```
5. JSON object returned:
```json
{
  "id": "pi_3Qr6qmR50r9GSPB10CBVrg7K",
  "object": "payment_intent",
  "amount": 10000,
  "amount_capturable": 0,
  "amount_details": {
    "tip": {}
  },
  "amount_received": 7500,
  "application": null,
  "application_fee_amount": null,
  "automatic_payment_methods": {
    "allow_redirects": "always",
    "enabled": true
  },
  "canceled_at": null,
  "cancellation_reason": null,
  "capture_method": "manual",
  "charges": {
    "object": "list",
    "data": [
      {
        "id": "ch_3Qr6qmR50r9GSPB10hiB9SdC",
        "object": "charge",
        "amount": 10000,
        "amount_captured": 7500,
        "amount_refunded": 2500,
        "application": null,
        "application_fee": null,
        "application_fee_amount": null,
        "balance_transaction": "txn_3Qr6qmR50r9GSPB10f3Z3EOW",
        "billing_details": {
          "address": {
            "city": null,
            "country": null,
            "line1": null,
            "line2": null,
            "postal_code": null,
            "state": null
          },
          "email": null,
          "name": null,
          "phone": null
        },
        "calculated_statement_descriptor": "Stripe",
        "captured": true,
        "created": 1739232087,
        "currency": "usd",
        "customer": "cus_Rkb73S7j8T0ZG1",
        "description": null,
        "destination": null,
        "dispute": null,
        "disputed": false,
        "failure_balance_transaction": null,
        "failure_code": null,
        "failure_message": null,
        "fraud_details": {},
        "invoice": null,
        "livemode": false,
        "metadata": {},
        "on_behalf_of": null,
        "order": null,
        "outcome": {
          "advice_code": null,
          "network_advice_code": null,
          "network_decline_code": null,
          "network_status": "approved_by_network",
          "reason": null,
          "risk_level": "normal",
          "risk_score": 20,
          "seller_message": "Payment complete.",
          "type": "authorized"
        },
        "paid": true,
        "payment_intent": "pi_3Qr6qmR50r9GSPB10CBVrg7K",
        "payment_method": "pm_1Qr5vQR50r9GSPB1IMd2aKQl",
        "payment_method_details": {
          "card": {
            "amount_authorized": 10000,
            "authorization_code": null,
            "brand": "visa",
            "capture_before": 1739836887,
            "checks": {
              "address_line1_check": null,
              "address_postal_code_check": null,
              "cvc_check": null
            },
            "country": "US",
            "exp_month": 2,
            "exp_year": 2026,
            "extended_authorization": {
              "status": "disabled"
            },
            "fingerprint": "JszuYPo2snHwMFMX",
            "funding": "credit",
            "incremental_authorization": {
              "status": "unavailable"
            },
            "installments": null,
            "issuer": "Stripe Payments UK Limited",
            "last4": "4242",
            "mandate": null,
            "moto": null,
            "multicapture": {
              "status": "unavailable"
            },
            "network": "visa",
            "network_token": {
              "used": false
            },
            "network_transaction_id": "741151221178980",
            "overcapture": {
              "maximum_amount_capturable": 10000,
              "status": "unavailable"
            },
            "regulated_status": "unregulated",
            "three_d_secure": null,
            "wallet": null
          },
          "type": "card"
        },
        "radar_options": {},
        "receipt_email": null,
        "receipt_number": null,
        "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUXI1R2lSNTByOUdTUEIxKOKnqr0GMga52164Xu46LBarp_umGF8x9Ma7iAkGu7aOnoZOTceZ0zFuQbS7ljCUZHTC_3RBmP2eNQ29",
        "refunded": false,
        "review": null,
        "shipping": null,
        "source": null,
        "source_transfer": null,
        "statement_descriptor": null,
        "statement_descriptor_suffix": null,
        "status": "succeeded",
        "transfer_data": null,
        "transfer_group": null
      }
    ],
    "has_more": false,
    "total_count": 1,
    "url": "/v1/charges?payment_intent=pi_3Qr6qmR50r9GSPB10CBVrg7K"
  },
  "client_secret": "pi_3Qr6qmR50r9GSPB10CBVrg7K_secret_uysSuyPs0U7QkhisWhVOP8Fjw",
  "confirmation_method": "automatic",
  "created": 1739231836,
  "currency": "usd",
  "customer": "cus_Rkb73S7j8T0ZG1",
  "description": null,
  "invoice": null,
  "last_payment_error": null,
  "latest_charge": "ch_3Qr6qmR50r9GSPB10hiB9SdC",
  "livemode": false,
  "metadata": {},
  "next_action": null,
  "on_behalf_of": null,
  "payment_method": "pm_1Qr5vQR50r9GSPB1IMd2aKQl",
  "payment_method_configuration_details": {
    "id": "pmc_1Qr5HER50r9GSPB1Db86Mp9s",
    "parent": null
  },
  "payment_method_options": {
    "affirm": {},
    "amazon_pay": {
      "express_checkout_element_session_id": null
    },
    "card": {
      "installments": null,
      "mandate_options": null,
      "network": null,
      "request_three_d_secure": "automatic"
    },
    "cashapp": {},
    "klarna": {
      "preferred_locale": null
    },
    "link": {
      "persistent_token": null
    }
  },
  "payment_method_types": [
    "card",
    "klarna",
    "link",
    "affirm",
    "cashapp",
    "amazon_pay"
  ],
  "processing": null,
  "receipt_email": null,
  "review": null,
  "setup_future_usage": null,
  "shipping": null,
  "source": null,
  "statement_descriptor": null,
  "statement_descriptor_suffix": null,
  "status": "succeeded",
  "transfer_data": null,
  "transfer_group": null
}
```

What Happens...?

When only a portion of an authorization is captured, in this case \$75.00/\$100.00, the other portion of the authorization for the charge is refunded.

### 2d. How do steps 2a-2c show on the customer’s bank statement?

Walking through steps 2a-2c, they show on the customer's banke statement as follows:
2a - When the authorization, in this case a PaymentIntent Object, is created it will show on a customer's bank statement as a pending charge for the amount specificed in the authorization, in this case $100.00.
2b - See screenshots...
2c - When a partial payment capture is completed, the customer's statement may say something along the lines of "Partial Capture", or show a capture for the full amount with a refund for the amount that was not captured.

### 2e. Name and describe 2 distinct business models/use cases that would require auth and then capture at a later time.

1. Vacation rentals, such as AirBnB and Vrbo, in which an authorization could be placed at the time of a booking, and then charged later before the stay, and a hold could be placed for the duration of the stay and refunded later for any incidentals or damages.
2. Car Reservations, in which an authorization can be placed to guarantee payment on the day the rental begins, and in the same case as above, a hold can be placed and refunded in the case of any incidentals or damages.

## Question 3 | Stripe Connect
Through our [Connect platform product](https://stripe.com/connect), Stripe enables platforms like Lyft to collect payments from riders and also payout drivers. In Stripe API terminology, a rider is a “customer” and a driver is a “connected account.” There are three different types of Connect accounts. For this question, you will be **making API calls** with [Custom Connect accounts](https://docs.stripe.com/connect/custom-accounts). Use this [Connect test data](https://docs.stripe.com/connect/testing) as needed. Note that while many of these actions can be done using the Dashboard, we ask that you **use the API** to complete the requests.

### 3a. Create a Custom Connect connected account. Provide the account ID.

Steps:

Account ID: ``

### 3b. Create a “destination” charge for a Lyft ride in which the rider pays $20 and the driver receives $15. Provide the Payment Intent ID.

Steps:

Payment Intent ID: ``

### 3c. For this ride, how much is Lyft’s platform fee?

Platform Fee: ``

### 3d. How much is the Stripe processing fee for this ride?

Processing Fee: ``

### 3e. What are Lyft's net earnings for this ride?

Net Earnings: ``

### 3f. Now, try to have Lyft charge the driver $2 to cover the cost of the neon-lighted Lyft sign that sits in their dashboard. Provide the ID for that request.

Steps:

Request ID: ``

### 3g. Tell us about how you went about solving 3F. What is your API call doing?

My API call is...

### 3h. Aside from rideshare, name a business or industry that should use Stripe Connect and why.

A business or industry that should use Stripe Connect is...

## Question 4 | Responding to Users
For this prompt, imagine you're a TAM supporting a user across Stripe's portfolio of products and they wrote into Stripe:
> Good news, we got go ahead for our planned streaming service. Development will start next week and we’re looking to understand how we can charge our users on a monthly basis, it looks like Stripe can help with that?
> We have two plans in mind:
> - Plan A: Flat rate of $24.99 per month for unlimited usage of the service
> - Plan B: $10.99 for the first 100 GB and $1.00 per subsequent 10 GB
> 
> Can you please give an overview of how this could be achieved through the API? As you know, we use Python in our environment, so if you could share the API calls with the required parameters needed, that'd be great
> Finally, if we wanted to introduce a coupon into the mix, how would that work?
> Best,
> [Customer's Name]

**How would you respond?**
